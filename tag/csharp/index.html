<!DOCTYPE html>
<html lang="en-US">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <title>Tag: csharp</title>
  <meta name="description" content="An overview of all posts tagged with 'csharp'">
  
  <!-- Twitter card -->
  <meta name="twitter:card" content="summary">
  <meta name="twitter:creator" content="@carlosschults">
  <meta name="twitter:site" content="@carlosschults">
  <meta name="twitter:domain" content="carlosschults.net">
  <meta name="twitter:title" content="Tag: csharp">
  <meta name="twitter:description" content="An overview of all posts tagged with 'csharp'">

   <!-- Facebook meta -->
  
  
  <meta property="og:title" content="Tag: csharp">
  <meta property="og:site_name" content="Carlos Schults / Blog" />
  <meta property="og:locale" content="en_US">  
  <meta property="og:type" content="website" />
  
  <meta property="og:url" content="http://carlosschults.net/tag/csharp/"/>
  <meta property="og:description" content="An overview of all posts tagged with 'csharp'">
  <link rel="stylesheet" href="/css/main.css">  
  
   <link rel="canonical" href="http://carlosschults.net/tag/csharp/">
   
  
  
  <link rel="alternate" hreflang="en" href="/tag/csharp/" />
  <link rel="alternate" hreflang="pt" href="/tag_ptbr/csharp/" />
  <link rel="alternate" type="application/rss+xml" title="carlos schults / blog" href="http://carlosschults.net/feed.xml">
</head>

  <body>

    <header class="site-header">
  <div class="wrapper">    
    <a class="site-title" href="/">carlos schults / blog</a>
    
    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">        
          
          <a class="page-link" href="/about/">About</a>
	  <a class="page-link" href="/search/">Search</a>
                  
      </div>
    </nav>

  </div>

</header>

<div class="wrapper" style="text-align: right; line-height: 2em">
  
  

  
   <a href="/tag/csharp/" class="en">en</a>  <a href="/tag_ptbr/csharp/" class="pt">pt</a> 
</div>


    <div class="page-content">
      <div class="wrapper">
        <h2 class="post_title">Tag: csharp</h2>

  
  
  
  
  
   <span class="post-meta">Jul 11, 2018</span>
    <h2>
          <a class="post-link" href="/en/4-common-datetime-mistakes-csharp/">4 Common Datetime Mistakes in C# — And How to Avoid Them</a>
    </h2>
    <div class="post-content">
    <p><img src="http://res.cloudinary.com/dz5ppacuo/image/upload/v1531165684/4-datetime-mistakes-1038x437_nm6csc.jpg" alt="" /></p>

<p><em>Editorial note: I originally wrote this post for the SubMain blog.  You can <a href="https://blog.submain.com/4-common-datetime-mistakes-c-avoid/">check out the original here, at their site</a>. While you’re there, have a look at CodeIt.Right, which can help you with time-related issues and much more.</em></p>

<p>Do you remember the “falsehoods programmers believe about <em>X</em>”  meme that became popular among software blogs a few years ago? The first one was about <a href="http://www.kalzumeus.com/2010/06/17/falsehoods-programmers-believe-about-names/">names</a>, but several others soon followed, covering topics such as <a href="https://www.mjt.me.uk/posts/falsehoods-programmers-believe-about-addresses/">addresses</a>, <a href="https://wiesmann.codiferes.net/wordpress/?p=15187&amp;lang=en">geography,</a> and <a href="https://wiesmann.codiferes.net/wordpress/?p=22201">online shopping</a>.</p>

<p>My favorite was <a href="http://infiniteundo.com/post/25326999628/falsehoods-programmers-believe-about-time">the one about time</a>. I hadn’t thought deeply about time and its intricacies up until that point, and I was intrigued by how a fundamental domain could be such a fertile ground for misunderstandings.</p>

<p>Now even though I like the post, I have a problem with it: it lists wrong assumptions, and then it basically stops there. The reader is likely to leave the article wondering:</p>

<ul>
  <li>Why are these assumptions falsehoods?</li>
  <li>How likely is it that I’ll get in trouble due to one of these assumptions?</li>
  <li>What’s the proper way of dealing with these issues?</li>
</ul>

<p>The article is interesting food for thought, but I think it’d make sense to provide more actionable information.</p>

<p>That’s what today’s post is about. I’m going to show you four common mistakes C#/.NET developers make when dealing with time. And that’s not all. I’ll also show what you should do to avoid them and make your code safer and easier to reason about.</p>

<h2 id="naively-calculating-durations">1. Naively Calculating Durations</h2>

<p>Consider the code below:</p>

<script src="https://gist.github.com/carlosschults/3e18612b9a9238382b6d4fa3c574a231.js"></script>

<p>Will this code work? It depends on where and when it’s going to run.</p>

<p>When you use <code class="highlighter-rouge">DateTime.Now</code>, the <code class="highlighter-rouge">DateTime</code> you get represents the current date and time local to your machine (i.e., it has the <code class="highlighter-rouge">Kind</code> property set to <code class="highlighter-rouge">Local</code>).</p>

<p>If you live in an area that observes DST (Daylight Saving Time), you know there’s one day in the year when all clocks must be moved forward a certain amount of time (generally one hour, but there are places that adjust by other offsets). Of course, there’s also the day when the opposite happens.</p>

<p>Now picture this: today is March 12th, 2017, and you live in New York City. You start using the program above. The <code class="highlighter-rouge">StartMatch()</code> method runs at exactly 01:00 AM.  One hour and 15 minutes later, the <code class="highlighter-rouge">EndMatch()</code> method runs. The calculation is performed, and the following text is shown:</p>

<p><em>Duration of the match: 00:02:15</em></p>

<p>I bet you’ve correctly guessed what just happened here: when clocks were about to hit 2 AM, DST just kicked in and moved them straight to 3 AM. Then <code class="highlighter-rouge">EndMatch</code> got back the current time, effectively adding a whole hour to the calculation. If the same had happened at the end of DST, the result would’ve been just 15 minutes!</p>

<p>Sure, the code above is just a toy example, but what if it were a payroll application? Would you like to pay an employee the wrong amount?</p>

<h3 id="what-to-do">What to Do?</h3>

<p>When calculating the duration of human activities, use UTC for the start and end dates. That way, you’ll be able to** unambiguously point to an instant in time**. Instead of using the <code class="highlighter-rouge">Now</code> property on <code class="highlighter-rouge">DateTime</code>, use `UtcNow to retrieve the date time already in UTC to perform the calculations:</p>

<script src="https://gist.github.com/carlosschults/82492845edaa8f8fc16c646ed2bbcf2a.js"></script>

<p>What if the <code class="highlighter-rouge">DateTime</code> objects you already have are set to Local? In that case, you should use the ToUniversalTime() method to convert them to UTC:</p>

<script src="https://gist.github.com/carlosschults/58837695af07386836753ef6541233aa.js"></script>

<h3 id="a-little-warning-about-touniversaltime">A Little Warning About ToUniversalTime()</h3>

<p>The usage of <code class="highlighter-rouge">ToUniversalTime()</code> — and its sibling, <code class="highlighter-rouge">ToLocalTime()</code>— can be a little tricky. The problem is that these methods make assumptions about what you want based on the value of the Kind property of your date, and that can cause unexpected results.</p>

<p>When calling <code class="highlighter-rouge">ToUniversalTime()</code>, one of the following things will happen:</p>

<ul>
  <li>If <code class="highlighter-rouge">Kind</code> is set to UTC, then the same value is returned.</li>
  <li>On the other hand, if it’s set to Local, the corresponding value in UTC is returned.</li>
  <li>Finally, if Kind is set to Unspecified,** then it’s assumed the datetime is meant to be local, **and the corresponding UTC datetime is returned.</li>
</ul>

<p>The problem we have here is <a href="https://codeofmatt.com/2013/04/25/the-case-against-datetime-now/#localkindsdontroundtrip">that local times don’t roundtrip</a>. They’re local as long as they don’t leave the context of your machine. If you save a local datetime to a database and then retrieve it back, the information that’s supposed to be local is lost: now it’s unspecified.</p>

<p>So, the following scenario can happen:</p>

<ul>
  <li>You retrieve the current date and time using <code class="highlighter-rouge">DateTime.UtcNow</code>.</li>
  <li>You save it to the database.</li>
  <li>Another part of the code retrieves this value and, unaware that it’s supposed to already be in UTC, calls <code class="highlighter-rouge">ToUniversalTime()</code> on it.</li>
  <li>Since the datetime is unspecified, the method will treat it as Local and perform an unnecessary conversion, generating a wrong value.</li>
</ul>

<p>How do you prevent this? It’s a recommended practice to use UTC to record the time when an event happened. My suggestion here is to follow this advice and also to make it explicit that you’re doing so. Append the “UTC” suffix to every database column and class property that holds a UTC datetime. Instead of Created, change it to CreatedUTC and so on. It’s not as pretty, but it’s definitely more clear.</p>

<h2 id="not-using-utc-when-it-should-be-used-and-vice-versa">2. Not Using UTC When It Should Be Used (and Vice Versa)</h2>

<p>We could define this as a universal rule: use UTC to record the time when events <em>happened</em>. When logging, auditing, and recording all types of timestamps in your application, UTC is the way to go.</p>

<p>So, use UTC everywhere! …Right? Nope, not so fast.</p>

<p>Let’s say you need to be able to reconstruct the local datetime — to the user’s perspective — of when something happened, and the only information you have is a timestamp in UTC. That’s a piece of bad luck.</p>

<p>In cases like this, it’d make more sense to either (a) store the datetime in UTC along with the user’s time zone or (b) use the <code class="highlighter-rouge">DateTimeOffset</code> type, which will record the local date along with the UTC offset, enabling you to reconstruct the UTC date from it when you need it.</p>

<p>Another common use case where UTC is not the right solution is <a href="https://stackoverflow.com/questions/19626177/how-to-store-repeating-dates-keeping-in-mind-daylight-savings-time?noredirect=1&amp;lq=1">scheduling future local events</a>. You wouldn’t want to wake up one hour later or earlier in the days of DST transitions, right? That’s exactly what would happen if you’d set your alarm clock by UTC.</p>

<h2 id="not-validating-user-input">3. Not Validating User Input</h2>

<p>Let’s say you’ve created a simple Windows desktop app that lets users set reminders for themselves. The user enters the date and time at which they want to receive the reminder, clicks a button, and that’s it.</p>

<p>Everything seems to be working fine until a user from Brazil emails you, complaining the reminder she set for October 15th at 12:15 AM didn’t work. What happened?</p>

<h3 id="dst-strikes-back">DST Strikes Back</h3>

<p>The villain here is good old Daylight Saving Time again. In 2017, DST in Brazil started at midnight on October 15th. (Remember that Brazil is in the southern hemisphere.) So, the date-time combination the user supplied <strong>simply didn’t exist in her time zone!</strong></p>

<p>Of course, the opposite problem is also possible. When DST ends and clocks turn backward by one hour, this <strong>generates ambiguous times.</strong></p>

<h3 id="what-is-the-remedy">What Is the Remedy?</h3>

<p>How do you deal with those issues as a C# developer? The <code class="highlighter-rouge">TimeZoneInfo</code> class has got you covered. It not only represents a time zone but it also provides methods to check for a datetime validity:</p>

<script src="https://gist.github.com/carlosschults/2b94d57390b3518294730c01003f159c.js"></script>

<p>What should you do then? What should replace the “do something” comments in the snippets above?</p>

<p>You could show the user a message saying the input date is invalid. Or you could preemptively choose another date for the user.</p>

<p>Let’s talk about invalid times first. Your options: move forward or backward. It’s somewhat of an arbitrary decision, so which one should you pick? For instance, the Google Calendar app on Android chooses the former. And it makes sense when you think about it. That’s exactly what your clocks already did due to DST. Why shouldn’t you do the same?</p>

<p>And what about ambiguous times? You also have two options: choose between the first and second occurrences. Then again, it’s somewhat arbitrary, but my advice is to pick the first one. Since you have to choose one, why not make things simpler?</p>

<h2 id="mistaking-an-offset-for-a-time-zone">4. Mistaking an Offset for a Time Zone</h2>

<p>Consider the following timestamp: 1995-07-14T13:05:00.0000000-03:00. When asked what the -03:00 at the end is called, many developers answer, “a time zone.”</p>

<p>Here’s the thing. They probably correctly assume that the number represents the offset from UTC. Also, they’d probably see that you can get the corresponding time in UTC from the offset. (Many developers fail to understand that in a string like this, the offset is already applied: to get the UTC time, you should invert the offset sign. Only then should you add it to the time.)</p>

<p>The mistake is in thinking that the offset is all there is to a time zone. It’s not.  A time zone is a geographical area, and it consists of many pieces of information, such as:</p>

<ul>
  <li>One or more offsets. (DST is a thing, after all.)</li>
  <li>The dates when DST transitions happen. (These can and do change whenever governments feel like it.)</li>
  <li>The amount of time applied when transitions happened. (It’s not one hour everywhere.)</li>
  <li>The historical records of changes to the above rules.</li>
</ul>

<p>In short: don’t try to guess a time zone by the offset. You’ll be wrong most of the time.</p>

<h2 id="its-about-timeyou-learn-about-time">It’s About Time…You Learn About Time!</h2>

<p>This list is by no means exhaustive. I only wanted to give you a quick start in the fascinating and somewhat bizarre world of datetime issues. There are plenty of valuable resources out there for you to learn from, such as the <a href="https://stackoverflow.com/tags/timezone/info">time zone tag on Stack Overflow</a> or blogs such as <a href="https://codeblog.jonskeet.uk/">Jon Skeet’s</a> and <a href="https://codeofmatt.com/">Matt Johnson’s,</a> who are authors of the popular NodaTime library.</p>

<p>And of course, always use the tools at your disposal. For instance, <a href="https://blog.submain.com/codeit-right-rules-explained-part-2/">SubMain’s CodeIt.Right</a> has a rule to force you to specify a <code class="highlighter-rouge">IFormatProvider</code> in situations where it’s optional, which can save you from nasty bugs when parsing dates.</p>

    <a href="/en/4-common-datetime-mistakes-csharp/">read more...</a>
   </div>   
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
   <span class="post-meta">Jan 17, 2018</span>
    <h2>
          <a class="post-link" href="/en/cargo-cult-programming/">Cargo Cult Programming Is The Art of Programming by Coincidence</a>
    </h2>
    <div class="post-content">
    <p><img src="http://res.cloudinary.com/dz5ppacuo/image/upload/v1516152067/cargo-cult-programming-1037x438_spoxet.jpg" alt="" /></p>

<p><em>Editorial note: I originally wrote this post for the NDepend blog.  You can <a href="https://blog.ndepend.com/cargo-cult-programming/">check out the original here, at their site</a>. While you’re there, download NDepend and give it a try.</em></p>

<p>I first learned about cargo cult programming a few years ago. I remember thinking back then, “What a strange name for a programming-related concept.”</p>

<p>If you share my past self’s astonishment, then today’s post is for you!</p>

<p>First, you’ll see what cargo cult programming is and why you should care. Then, we’re going to look at some practical examples, using the C# language. Finally, we’ll close with advice about what you can do, as a developer, to avoid falling into this trap.</p>

<h2 id="cargo-cult-programming-doing-stuff-just-because">Cargo Cult Programming: Doing Stuff Just Because</h2>

<p><a href="https://en.wikipedia.org/wiki/Cargo_cult_programming">According to Wikipedia</a>, “Cargo cult programming is a style of computer programming characterized by the ritual inclusion of code or program structures that serve no real purpose.”</p>

<p>In other words, it’s when a developer writes code without really understanding it. The developer may use a very trial-and-error approach—maybe copy and paste some code from somewhere else and then tweak it and test it until works, or sort of works. Then the developer will stop tweaking the code, for fear it will stop working. In the process, maybe they leave some lines of code that don’t do anything.</p>

<p>Or maybe they tried to use an idiom they picked up from another developer while failing to understand that the contexts are different and it’s useless in the current situation.</p>

<p>Finally, it might just be lack of education: maybe the developer has a poor mental model of how the tools they’re using really work.</p>

<h2 id="why-is-cargo-cult-programming-a-problem">Why is Cargo Cult Programming a Problem?</h2>
<p>As Eric Lippert puts it, <a href="https://blogs.msdn.microsoft.com/ericlippert/2004/03/01/syntax-semantics-micronesian-cults-and-novice-programmers/">cargo cult programmers struggle to make meaningful changes to a program</a> and end up using a trial-and-error approach since they don’t understand the inner workings of the code they’re about to change.</p>

<p>This is not so different from what the <a href="https://pragprog.com/the-pragmatic-programmer/extracts/coincidence">Pragmatic Bookshelf calls “programming by coincidence”</a>:</p>

<blockquote>
  <p>Fred doesn’t know why the code is failing because he didn’t know why it worked in the first place. It seemed to work, given the limited “testing” that Fred did, but that was just a coincidence.</p>
</blockquote>

<p>That single sentence pretty much sums it up for me: if you don’t know how or why your code works, neither will you understand what happened when it no longer works.</p>

<h2 id="origin-of-the-term">Origin of the Term</h2>
<p>Although practices that are considered cargo cult today <a href="https://en.wikipedia.org/wiki/Cargo_cult#First_occurrences">have been recorded as early as the late 19th century</a>, the term itself dates from 1945, when it was first used to describe practices that emerged during and after World War II between Melanesian islanders.</p>

<p>These islanders would mimic the soldiers’ behavior, such as dressing up as flight controllers and waving sticks, hoping that airplanes would descend from the skies with a lot of cargo.</p>

<p>Since then, the term cargo cult has been used in a variety of contexts to mean <strong>to imitate form without content</strong>—to perfectly copy the superficial elements while failing to understand the deeper meanings and workings of whatever one’s trying to emulate.</p>

<h2 id="talk-is-cheap-show-me-the-code">Talk is Cheap; Show Me the Code!</h2>
<p>Enough with the history lesson. Time to see some code! I’m going to show you five examples of cargo cult programming in the C# language.</p>

<h3 id="checking-a-non-nullable-value-type-for-null">Checking a Non-Nullable Value Type for Null</h3>
<p>This one is a pet peeve of mine since I see it a lot in production code. It goes like this:</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#">	<span class="k">public</span> <span class="n">Product</span> <span class="nf">Find</span><span class="p">(</span><span class="kt">int</span> <span class="n">id</span><span class="p">)</span>
	<span class="p">{</span>
   	   <span class="k">if</span> <span class="p">(</span><span class="n">id</span> <span class="p">!=</span> <span class="k">null</span><span class="p">)</span> <span class="c1">// this check is useless
</span>	   <span class="p">{</span>
	       <span class="n">Console</span><span class="p">.</span><span class="nf">WriteLine</span><span class="p">(</span><span class="s">"This line will always get reached."</span><span class="p">);</span>
	   <span class="p">}</span>
	
	   <span class="k">return</span> <span class="k">new</span> <span class="nf">Product</span><span class="p">();</span>
	<span class="p">}</span></code></pre></figure>

<p>Here we have a developer that probably doesn’t grok the <a href="http://carlosschults.net/en/value-reference-types-in-csharp/">difference between value and reference types</a>. It would be completely forgivable, in the case of a junior developer, except for the fact that the compiler warns you about that.</p>

<p>You could argue that I’m nitpicking. After all, the code will run fine in spite of this. In fact, the check won’t even be included in the resulting IL, as you can see from this print of a decompiling tool:</p>

<p><img src="http://res.cloudinary.com/dz5ppacuo/image/upload/v1515684957/just-decompile1_qk69k2.png" alt="An image depicting a code excerpt that does not contain the null check." /></p>

<p>You can see in this code snippet that the compiler has optimized the null check out.</p>

<p>There are plenty of worse problems, granted. Yes, the application won’t <em>crash</em> because of this. So what’s the big deal?</p>

<p>Well, for starters, I’d be worried about a development shop where the sole quality measure was “it runs without crashing.” But the real problem is that this type of code shows a lack of understanding of some fundamental characteristics of the language and platform that can bite you in the future.</p>

<h3 id="unnecessary-use-of-tolist-in-linq-to-object-queries">Unnecessary Use of ToList() in LINQ to Object Queries</h3>
<p>Like the previous one, this is something I routinely see in production code. Consider the code below:</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#">	<span class="n">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">users</span><span class="p">.</span><span class="nf">ToList</span><span class="p">()</span>
	<span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">PremiumUser</span><span class="p">)</span>
	<span class="p">.</span><span class="nf">ToList</span><span class="p">()</span>
	<span class="p">.</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="n">x</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">Birth</span> <span class="p">=</span> <span class="n">x</span><span class="p">.</span><span class="n">DateOfBirth</span> <span class="p">})</span>
	<span class="p">.</span><span class="nf">ToList</span><span class="p">();</span></code></pre></figure>

<p>The problem we have here is that these calls to <code class="highlighter-rouge">ToList()</code> are completely unnecessary (except maybe the last one, if you really needed the result to be a <code class="highlighter-rouge">List</code> and not only an <code class="highlighter-rouge">IEnumerable</code>).</p>

<p>In my experience, this happens when the developer doesn’t understand the nature of LINQ; they erroneously think that the LINQ methods belong to the concrete type <code class="highlighter-rouge">List&lt;T&gt;</code> instead of being extension methods that can be used with any <code class="highlighter-rouge">IEnumerable&lt;T&gt;</code> implementation.</p>

<p>By calling <code class="highlighter-rouge">ToList()</code> several times like this, the developer creates several new lists, which can be detrimental to the performance of the application.</p>

<p>You could rewrite the code above like this:</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#">	<span class="n">var</span> <span class="n">result</span> <span class="p">=</span> <span class="n">users</span><span class="p">.</span><span class="nf">Where</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="n">x</span><span class="p">.</span><span class="n">PremiumUser</span><span class="p">).</span><span class="nf">Select</span><span class="p">(</span><span class="n">x</span> <span class="p">=&gt;</span> <span class="k">new</span> <span class="p">{</span> <span class="n">Name</span> <span class="p">=</span> <span class="n">x</span><span class="p">.</span><span class="n">Name</span><span class="p">,</span> <span class="n">Birth</span> <span class="p">=</span> <span class="n">x</span><span class="p">.</span><span class="n">DateOfBirth</span> <span class="p">});</span></code></pre></figure>

<h3 id="unnecessary-conversions">Unnecessary Conversions</h3>
<p>Consider the following line:</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#">	<span class="n">DateTime</span> <span class="n">creationDate</span> <span class="p">=</span> <span class="n">DateTime</span><span class="p">.</span><span class="nf">Parse</span><span class="p">(</span><span class="n">row</span><span class="p">[</span><span class="s">"creation_date"</span><span class="p">].</span><span class="nf">ToString</span><span class="p">());</span></code></pre></figure>

<p>Here we have not only one but two unnecessary conversions. First, the developer creates a new string and then parses it to <code class="highlighter-rouge">DateTime</code> when a simple cast would have sufficed:</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#">	<span class="n">DateTime</span> <span class="n">creationDate</span> <span class="p">=</span> <span class="p">(</span><span class="n">DateTime</span><span class="p">)</span><span class="n">row</span><span class="p">[</span><span class="s">"creation_date"</span><span class="p">];</span></code></pre></figure>

<p>This example assumes that the underlying database type is some specific type for dealing with dates (for instance, <code class="highlighter-rouge">date</code> or <code class="highlighter-rouge">datetime</code> in SQL Server). Of course, if you were using an inadequate type (such as <code class="highlighter-rouge">varchar</code>) then this would be a problem of its own.</p>

<h3 id="try-catch-everywhere">Try-Catch Everywhere</h3>
<p>Also known as Pokémon syndrome (“Gotta catch ’em all!”), the anti-pattern here is to add a try-catch block to every single line that could possibly throw an exception.</p>

<p>Bonus points if the code is attempting to catch <code class="highlighter-rouge">System.Exception</code> instead of a more specific exception, thus blurring the distinction between expected and unexpected errors.</p>

<p>More bonus points if the catch block doesn’t contain any code at all!</p>

<p>The general advice here is this: never catch unless you have a very specific reason for doing so. Otherwise, just the let the exception bubble up until it’s dealt with by the top-level exception handler.</p>

<p>If this advice seems vague (“How would I know if I have the right reason for catching an exception?”), that’s because it is vague. It’s beyond the scope of this post to go deeper into this matter, but <a href="https://blogs.msdn.microsoft.com/ericlippert/2008/09/10/vexing-exceptions/">Eric Lippert’s excellent article called “Vexing Exceptions”</a> will greatly improve your understanding of exception handling.</p>

<h3 id="using-stringbuilder-everywhere">Using StringBuilder Everywhere</h3>
<p>It’s the stuff of superhero movies: after reading somewhere that concatenating strings by using the ‘+’ operator is incredibly inefficient, the well-meaning developer takes upon themselves the Herculean task of updating every single concatenation in the codebase to <code class="highlighter-rouge">StringBuilder</code>.</p>

<p>The reasoning for this is, of course, that <code class="highlighter-rouge">System.String</code> is immutable. So every time you “modify” a string, you’re in fact creating a new instance in memory, which can hurt performance pretty badly.</p>

<p>Well, guess what? The compiler is pretty smart. Let’s say you have the following line:</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#">	<span class="kt">string</span> <span class="n">a</span> <span class="p">=</span> <span class="s">"Hello "</span> <span class="p">+</span> <span class="s">"World"</span><span class="p">;</span></code></pre></figure>

<p>This, in fact, gets translated to</p>

<figure class="highlight"><pre><code class="language-c#" data-lang="c#">	<span class="kt">string</span> <span class="n">a</span> <span class="p">=</span> <span class="s">"Hello World"</span><span class="p">;</span></code></pre></figure>

<p>The fast rule of thumb is it’s fine to use the simple concatenation when you know the number of strings to append in compile time. Otherwise, a <a href="https://stackoverflow.com/a/21644889"><code class="highlighter-rouge">StringBuilder</code> probably makes more sense</a>.</p>

<p>Of course, some scenarios aren’t that clear-cut. The only advice worth giving here is to do your homework. When in doubt, research and benchmark to your heart’s content.</p>

<p>I’ll leave you with more sound advice from Eric Lippert:</p>

<blockquote>
  <p>Unnecessary code changes are expensive and dangerous; <strong>don’t make performance-based changes unless you’ve identified a performance problem.</strong></p>
</blockquote>

<h2 id="is-there-a-remedy">Is There a Remedy?</h2>
<p>I’d say it’s fair to assume that more inexperienced developers are more prone to commit mistakes due to cargo cult programming. But no developer is really immune to it, independent of their knowledge or experience.</p>

<p>We’re only human after all. Tiredness, deadlines, cognitive biases, and (to be really honest) the eventual laziness can turn even the best developer into a cargo cult programmer.</p>

<p>Unfortunately, there’s no 100%  guaranteed way of preventing this from happening. Yet there are some measures you could take to, at least, decrease the odds.</p>

<p>Let’s take a look at some of them.</p>

<h3 id="use-code-reviewpair-programming">Use Code Review/Pair Programming</h3>
<p>The first measure you could take to avoid cargo cult programming is to simply get a second pair of eyes on your code. The benefits of having a second person reviewing each line of code before it goes to production can’t be overstated. And while code review and pair programming aren’t perfect equivalents, both of these practices will bring you this benefit.</p>

<h3 id="always-test-your-hypothesis">Always Test Your Hypothesis</h3>
<p>Write unit tests (and other types of tests as well). Monitor your application in production. If something doesn’t perform well, benchmark the heck out of it. Don’t just assume things. Testing your hypothesis can bring valuable insights and save you when your intuition gets it wrong.</p>

<h3 id="read-other-peoples-code">Read Other People’s Code</h3>
<p>Reading other people’s code is a great way to learn. It’s a perfect tool to compare your own ideas and assumptions against what other developers are doing, exposing you to novel concepts that can force you to gain a deeper understanding of the issues at hand.</p>

<p>In the era of <a href="http://github.com/">GitHub</a>, there isn’t much of an excuse for not doing that.</p>

<h3 id="learn-from-your-tools">Learn From Your Tools</h3>
<p>There are currently a plethora of tools that can help <a href="https://www.ndepend.com/">your team improve the quality of their code</a>. Here’s the thing, though: you shouldn’t just use these tools. You should also learn from them. If you use NDepend, <a href="https://www.ndepend.com/default-rules/webframe.html">read about its rules</a>. Try and understand the rationale behind them. What are the principles and best practices that guided its authors when coming up with the rules?</p>

<p>The same goes for other types of tools—and even the warnings the compiler gives you.</p>

<h2 id="computer-science-not-computer-superstition">Computer Science, Not Computer <em>Superstition</em></h2>
<p>Even though no one is immune to cargo cult programming, we should strive to overcome it. There’s hard-earned industry wisdom at our disposal, slowly generated over more than seven decades. Let’s use it. Let’s understand our tools and our craft and write better software.</p>

    <a href="/en/cargo-cult-programming/">read more...</a>
   </div>   
  
  
  
  
  
  
  
  
  
  
  
   <span class="post-meta">Dec 20, 2017</span>
    <h2>
          <a class="post-link" href="/en/csharp-8-features/">C# 8.0 Features: A Glimpse of the Future</a>
    </h2>
    <div class="post-content">
    <p><img src="http://res.cloudinary.com/dz5ppacuo/image/upload/v1513817072/csharp8-1037x438_skogpz.jpg" alt="" /></p>

<p>C# 8.0 is coming and will bring some great new features. Let’s check out what the future holds for us.</p>


    <a href="/en/csharp-8-features/">read more...</a>
   </div>   
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
   <span class="post-meta">Jun 5, 2017</span>
    <h2>
          <a class="post-link" href="/en/csharp-7-features-part-2/">C# 7 Features Worth Knowing - Part 2</a>
    </h2>
    <div class="post-content">
    <p><img src="http://res.cloudinary.com/dz5ppacuo/image/upload/v1489452722/charp7-features-cover_ciekql.jpg" alt="" /></p>

<p>In this post we’ll see some more new features from C# 7.0.</p>


    <a href="/en/csharp-7-features-part-2/">read more...</a>
   </div>   
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
   <span class="post-meta">Mar 13, 2017</span>
    <h2>
          <a class="post-link" href="/en/csharp-7-features/">C# 7 Features Worth Knowing - Part 1</a>
    </h2>
    <div class="post-content">
    <p><img src="http://res.cloudinary.com/dz5ppacuo/image/upload/v1489452722/charp7-features-cover_ciekql.jpg" alt="" /></p>

<p>C# 7 is finally among us. Time to check out some of its features.</p>


    <a href="/en/csharp-7-features/">read more...</a>
   </div>   
  
  
  
  
  
  
  
  
  
   <span class="post-meta">Mar 6, 2017</span>
    <h2>
          <a class="post-link" href="/en/csharp-6-features/">It's about time you start using these C# 6 features</a>
    </h2>
    <div class="post-content">
    <p><img src="http://res.cloudinary.com/dz5ppacuo/image/upload/v1487896790/csharp6features_y5czrf.jpg" alt="" /></p>

<p>The 7th version of C# is coming, and it’s expected to bring some new and exciting features to our tool sets. Here’s the thing, though: Are you up to speed with its predecessor’s features?</p>


    <a href="/en/csharp-6-features/">read more...</a>
   </div>   
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
   <span class="post-meta">Jun 19, 2016</span>
    <h2>
          <a class="post-link" href="/en/value-reference-types-in-csharp-part-2/">Value and reference types in C#, Part 2 - Why can't a DateTime be null?</a>
    </h2>
    <div class="post-content">
    <p><img src="http://res.cloudinary.com/dz5ppacuo/image/upload/v1466341001/csharp-min_buiizq.png" alt="" /></p>

<p>“Why is not allowed to assign <code class="highlighter-rouge">null</code> to a DateTime?” Again and again, this question keeps showing up on StackOverflow and similar sites. Different phrasing, maybe a different type <a href="http://stackoverflow.com/questions/6191339/why-type-int-is-never-equal-to-null">(“Why type “int” is never equal to ‘null’?”)</a>, but the same question, in essence. Which is only natural, considering that probably thousands of developers join the field every year.</p>


    <a href="/en/value-reference-types-in-csharp-part-2/">read more...</a>
   </div>   
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
   <span class="post-meta">Jan 30, 2016</span>
    <h2>
          <a class="post-link" href="/en/value-reference-types-in-csharp/">Value and reference types in C#</a>
    </h2>
    <div class="post-content">
    <p><img src="http://res.cloudinary.com/dz5ppacuo/image/upload/v1466341001/csharp-min_buiizq.png" alt="" /></p>

<p>This is my first “real” post here on my blog, and I decided to talk about value types and reference types. This is somewhat of a basic subject, in the sense that it is something that you should already know if you write C# code for a living.But at the same time, it can be a little non-intuitive if you’re not an experienced developer.</p>


    <a href="/en/value-reference-types-in-csharp/">read more...</a>
   </div>   
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  
  



      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">
    <div class="footer-col-wrapper">
      <div class="footer-col footer-col-1">
        <ul class="contact-list">         
        </ul>
      </div>

      <div class="footer-col footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/carlosschults"><span class="icon icon--github"><svg viewBox="0 0 16 16"><path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/></svg>
</span><span class="username">carlosschults</span></a>

          </li>
          

          
          <li>
            <a href="https://twitter.com/carlosschults"><span class="icon icon--twitter"><svg viewBox="0 0 16 16"><path fill="#828282" d="M15.969,3.058c-0.586,0.26-1.217,0.436-1.878,0.515c0.675-0.405,1.194-1.045,1.438-1.809c-0.632,0.375-1.332,0.647-2.076,0.793c-0.596-0.636-1.446-1.033-2.387-1.033c-1.806,0-3.27,1.464-3.27,3.27 c0,0.256,0.029,0.506,0.085,0.745C5.163,5.404,2.753,4.102,1.14,2.124C0.859,2.607,0.698,3.168,0.698,3.767 c0,1.134,0.577,2.135,1.455,2.722C1.616,6.472,1.112,6.325,0.671,6.08c0,0.014,0,0.027,0,0.041c0,1.584,1.127,2.906,2.623,3.206 C3.02,9.402,2.731,9.442,2.433,9.442c-0.211,0-0.416-0.021-0.615-0.059c0.416,1.299,1.624,2.245,3.055,2.271 c-1.119,0.877-2.529,1.4-4.061,1.4c-0.264,0-0.524-0.015-0.78-0.046c1.447,0.928,3.166,1.469,5.013,1.469 c6.015,0,9.304-4.983,9.304-9.304c0-0.142-0.003-0.283-0.009-0.423C14.976,4.29,15.531,3.714,15.969,3.058z"/></svg>
</span><span class="username">carlosschults</span></a>

          </li>
          
        </ul>
      </div>

      <div class="footer-col footer-col-3">
        <p>Articles on software development, databases and several tech related subjects.</p>
      </div>
    </div>

  </div>

</footer>

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-92788641-1', 'auto');
  ga('send', 'pageview');

</script>

  </body>

</html>
